/* SM Includes */
#include <sourcemod>
#include <sourcebanspp>
#undef REQUIRE_PLUGIN
#include <updater>

#pragma semicolon 1
#pragma newdecls required
#pragma tabsize 4

/* Plugin Info */
#define VERSION "1.0.1"
#define UPDATE_URL "https://sys.froidgaming.net/AntiExploit/updatefile.txt"
#define PREFIX "{default}[{lightblue}FroidGaming.net{default}]"

public Plugin myinfo =
{
	name = "[FroidApp] Anti Exploit",
	author = "FroidGaming.net",
	description = "Anti Exploit.",
	version = VERSION,
	url = "https://froidgaming.net"
};

public void OnPluginStart()
{
    AddCommandListener(resetteam, "resetteam");
}

Action resetteam(int iClient, const char[] szCommand, int iArgc)
{
    SBPP_BanPlayer(0, iClient, 0, "[FroidAC] Exploit Detected #1");
    return Plugin_Stop;
}

public Action OnPlayerRunCmd(int Client, int& Buttons, int& Imp, float Vel[3], float Angles[3], int& Weapon, int& Subtype, int& CMDnum, int& Tickcount, int& Seed, int Mouse[2])
{
	if(Client > 0 && IsClientInGame(Client))
	{
		if(Tickcount == 0 && Vel[0] == 0.0 && Vel[1] == 0.0 && Vel[2] == 0.0 && !(Buttons & IN_ATTACK))
		{
			CreateTimer(0.1, BanPlayerDelayed, Client, TIMER_FLAG_NO_MAPCHANGE);
		}
	}
}

public Action BanPlayerDelayed(Handle pTimer, int Client)
{
	if(Client > 0 && IsClientInGame(Client) && IsPlayerAlive(Client))
	{
        SBPP_BanPlayer(0, Client, 0, "[FroidAC] Exploit Detected #2");
	}
}